# Auth-related schemas
RegisterRequest:
  type: object
  required: [ login, password, firstName, lastName ]
  properties:
    login:
      type: string
      format: email
      description: "Email пользователя"
    password:
      type: string
      format: password
      minLength: 8
      description: "Пароль пользователя"
    firstName:
      type: string
      minLength: 2
      maxLength: 50
      description: "Имя пользователя"
    lastName:
      type: string
      minLength: 2
      maxLength: 50
      description: "Фамилия пользователя"
    phone:
      type: string
      nullable: true
      description: "Номер телефона"
    telegramNickname:
      type: string
      nullable: true
      description: "Telegram никнейм"

LoginRequest:
  type: object
  required: [ login, password ]
  properties:
    login: { type: string }
    password: { type: string, format: password, minLength: 8 }

JwtResponse:
  type: object
  properties:
    token: { type: string }

TelegramUserDto:
  type: object
  required: [ id, first_name, auth_date, hash ]
  properties:
    id: { type: integer, format: int64, description: "Telegram User ID" }
    first_name: { type: string, description: "Имя пользователя из Telegram" }
    last_name: { type: string, nullable: true, description: "Фамилия пользователя из Telegram" }
    username: { type: string, nullable: true, description: "Username пользователя в Telegram" }
    photo_url: { type: string, format: uri, nullable: true, description: "URL фотографии профиля" }
    auth_date: { type: integer, format: int64, description: "Unix timestamp авторизации" }
    hash: { type: string, description: "Хеш для проверки подлинности данных" }

ChangePasswordRequest:
  type: object
  required: [ currentPassword, newPassword ]
  properties:
    currentPassword:
      type: string
      format: password
      description: "Текущий пароль пользователя для подтверждения"
      example: "currentSecretPassword123"
    newPassword:
      type: string
      format: password
      minLength: 8
      maxLength: 128
      description: |
        Новый пароль. Требования:
        - Минимум 8 символов
        - Максимум 128 символов
        - Должен содержать хотя бы одну заглавную букву
        - Должен содержать хотя бы одну строчную букву
        - Должен содержать хотя бы одну цифру
        - Может содержать специальные символы
      example: "NewSecurePassword123!"
    confirmPassword:
      type: string
      format: password
      description: "Подтверждение нового пароля (должно совпадать с newPassword)"
      example: "NewSecurePassword123!"

ChangePasswordResponse:
  type: object
  properties:
    success:
      type: boolean
      description: "Флаг успешного изменения пароля"
      example: true
    message:
      type: string
      description: "Сообщение об успешном изменении пароля"
      example: "Пароль успешно изменен"
    changedAt:
      type: string
      format: date-time
      description: "Дата и время изменения пароля"
      example: "2024-03-15T14:30:00Z"
    newToken:
      type: string
      nullable: true
      description: "Новый JWT токен, если требуется обновление сессии"
